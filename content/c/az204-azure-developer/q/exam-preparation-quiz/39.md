---
title: "Analyze Cosmos DB Query Partition Behavior"
type: "question"
layout: "single"
answers:
    - id: "answer1"
      title: "Yes, the query is a cross-partition query"
      correct: true
      explain: "The query filters on UserId, but the container is partitioned by StudentId. Since the query doesn't include the partition key (StudentId) in its WHERE clause, Cosmos DB must execute the query across all partitions to find documents matching UserId = '12345'. This cross-partition query will consume more RUs and have higher latency."
    - id: "answer2"
      title: "No, the query is an in-partition query"
      correct: false
      explain: "An in-partition query requires filtering on the exact partition key field with an equality operator. This query filters on UserId while the partition key is StudentId. Without the partition key in the WHERE clause, Cosmos DB cannot route the query to a single partitionâ€”it must scan all partitions, making it a cross-partition query."
link: "https://learn.microsoft.com/en-us/azure/cosmos-db/nosql/how-to-query-container"
more: "Learn more about Cosmos DB Queries"
learn: "Query Cosmos DB Containers"
---

You work as a Database Developer for MDFT Pro, a well-known training agency that delivers certification courses to students worldwide. Mark, the Query Optimization Specialist, has asked you to evaluate query patterns for the Student Enrollment Management application. The application uses Azure Cosmos DB with a container partitioned by StudentId. Different queries are used to retrieve enrollment data, and you need to determine which queries are efficiently routed to single partitions versus queries that must scan across all partitions. Understanding query behavior is critical for optimizing performance and minimizing RU consumption.

```powershell
$resourceGroupName = "StudentResourceGroup"
$accountName = "MDFTProCosmosAccount"
$databaseName = "EnrollmentDatabase"
$containerName = "StudentEnrollments"
$partitionKeyPath = "/StudentId"
$autoscaleMaxThroughput = 5000
New-AzCosmosDBSqlContainer
	-ResourceGroupName $resourceGroupName
	-AccountName $accountName
	-DatabaseName $databaseName
	-Name $containerName
	-PartitionKeyKind Hash
	-PartitionKeyPath $partitionKeyPath
	-AutoscaleMaxThroughput $autoscaleMaxThroughput
```

You create the following query that targets the container:

```sql
SELECT * FROM c WHERE c.UserId = '12345'
```

Is the following statement about the query true?

**Statement:** The query is a cross-partition query.
