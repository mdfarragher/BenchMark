---
title: "Complete The T-SQL Statement"
type: "question"
layout: "single"
answers:
    - id: "answer1"
      title: "OPEN"
      correct: false
      explain: "OPEN is not a valid function for reading bulk data in Transact-SQL. It's used for opening cursors, not for external data access."
    - id: "answer2"
      title: "OPENJSON"
      correct: false
      explain: "OPENJSON is used for parsing JSON data, but in this scenario we're reading from Parquet files, which requires a different function."
    - id: "answer3"
      title: "OPENROWSET"
      correct: true
      explain: "OPENROWSET is the correct function to use for bulk reading data from external files like Parquet in Azure Synapse Analytics serverless SQL pools."
    - id: "answer4"
      title: "SELECT"
      correct: false
      explain: "SELECT is used to query data from tables, but it cannot directly access external files in bulk. You need OPENROWSET for that purpose."
link: "https://learn.microsoft.com/en-us/azure/synapse-analytics/sql/develop-openrowset"
more: "Learn more about OPENROWSET In Azure Synapse Analytics"
learn: "OPENROWSET In Azure Synapse Analytics"
---
You work for MDFT Pro, a well-known training agency that manages student enrollment applications through an Azure Synapse Analytics platform. Mark, the Database Architect, has asked you to build a database in an Azure Synapse Analytics serverless SQL pool to analyze historical enrollment data. 

The data is stored in Parquet files in an Azure Data Lake Storage Gen2 container. Each record contains student application information with fields for ID, house number, street address, and applicant names (up to two applicants per record). Mark needs you to create an external table that extracts only the address-related fields for geographical analysis of student demographics.

The records are structured as shown in the following sample:

```json
{
	"id": 123,
	"address_housenumber": "10c",
	"address_line1": "Abraham Lane",
	"applicant1_name": "Mark Farragher",
	"applicant2_name": "Claire Smith"
}
```

How should you complete the Transact-SQL statement?

```sql
CREATE EXTERNAL TABLE applications
WITH (
	LOCATION = 'applications/'
	DATA SOURCE = applications_ds,
	FILE FORMAT = applications_file_format
)
AS
SELECT
	id,
	[address_housenumber] as addressnumber,
	[address_line1] as addressline1
FROM _______________ (BULK
	'https://mdftpro.dfs.core.windows.net/applications/year=*/*.parquet',
	FORMAT = 'PARQUET'
) AS [r]
GO
```
