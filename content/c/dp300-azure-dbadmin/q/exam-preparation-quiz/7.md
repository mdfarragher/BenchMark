---
title: "Complete The Table Partitioning Statement"
type: "question"
layout: "single"
answers:
    - id: "answer1"
      title: "ProductKey"
      correct: false
      explain: "ProductKey is used for hash distribution, not partitioning. Partitioning on ProductKey wouldn't help with deleting data by date efficiently."
    - id: "answer2"
      title: "OrderDateKey"
      correct: true
      explain: "OrderDateKey should be used for partitioning because it enables efficient deletion of old data by dropping entire partitions based on date ranges."
    - id: "answer3"
      title: "CustomerKey"
      correct: false
      explain: "CustomerKey is not related to the time-based retention requirement. Partitioning on CustomerKey wouldn't help with deleting data older than five years."
    - id: "answer4"
      title: "SalesOrderNumber"
      correct: false
      explain: "SalesOrderNumber is not suitable for partitioning when the requirement is to delete data based on age. It doesn't provide time-based organization."
    - id: "answer5"
      title: "OrderQuantity"
      correct: false
      explain: "OrderQuantity is a numeric measure, not a time-based field, so it cannot be used to efficiently delete data older than five years."
    - id: "answer6"
      title: "UnitPrice"
      correct: false
      explain: "UnitPrice is a monetary value, not a time-based field, so it's not suitable for partitioning to meet the data retention requirement."
link: "https://learn.microsoft.com/en-us/azure/synapse-analytics/sql-data-warehouse/sql-data-warehouse-tables-partition"
more: "Learn more about Table Partitioning In Azure Synapse Analytics"
learn: "Table Partitioning In Azure Synapse"
---
You work for MDFT Pro, a well-known training agency that maintains course sales data in an Azure Synapse Analytics dedicated SQL pool. Mark, the Data Warehouse Administrator, has asked you to create a new fact table called FactCourseSales that will store information about course purchases, students, and trainers. The company has a data retention policy that requires keeping sales data for exactly five years, after which old records must be deleted. Mark emphasizes that the annual data deletion process should be as fast as possible, and the data should be distributed evenly across partitions to maintain query performance.

How should you complete the Transact-SQL statement?

```sql
CREATE TABLE [dbo].[FactCourseSales]
(
	[CourseKey] int NOT NULL,
	[OrderDateKey] int NOT NULL,
	[StudentKey] int NOT NULL,
	[SalesOrderNumber] nvarchar(20) NOT NULL,
	[OrderQuantity] smallint NOT NULL,
	[UnitPrice] money NOT NULL
)
WITH
(
	CLUSTERED COLUMNSTORE INDEX,
	DISTRIBUTION = HASH(CourseKey),
	PARTITION( [ _____________ ] RANGE RIGHT FOR VALUES
		(20210101, 20220101, 20230101, 20240101, 20250101)
	)
)
```
