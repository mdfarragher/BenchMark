---
title: "Choose the correct dataflow strategy for restricted time windows"
type: "question"
layout: "single"
answers:
    - id: "answer1"
      title: "Create a single query that extracts and transforms the data"
      explain: "Transformation dataflows may involve complex processing that increases refresh time and risk of failure, making them unsuitable when source access is limited to a short window."
    - id: "answer2"
      title: "Create an extraction query that loads the data, enable staging for this query, then create a transformation query that references the extraction query"
      correct: true
      explain: "This is the correct approach for restricted time windows. Enable staging on the extraction query so it materializes results to a staging lakehouse/warehouse. The transformation query then references the staged data and applies transformations without accessing the restricted source again. Without staging enabled, query folding could collapse both queries into one, defeating the purpose."
    - id: "answer3"
      title: "Create a shared dataset that can be reused by multiple Power BI reports"
      explain: "Shared datasets support reuse at the reporting layer but do not extract or stage source data, and they still require scheduled refresh that may fall outside the limited access window."
    - id: "answer4"
      title: "Create an extraction query that loads the data, then create a transformation query that references the extraction query"
      explain: "This approach is unreliable without enabling staging on the extraction query. Query folding can collapse both queries into a single execution at the source, meaning all transformations would be pushed back to the data source. This defeats the purpose of separating extraction from transformation and doesn't guarantee minimal access time to the restricted source."

link: "https://blog.fabric.microsoft.com/en-us/blog/data-factory-spotlight-dataflows-gen2"
more: "Learn more about staging dataflows in Fabric"
learn: "Staging Dataflows"
---

MDFT Pro operates a Fabric workspace containing a Microsoft Power BI report named **StudentReport**. The organization does not currently have an enterprise data warehouse. 

You need to set up a dataflow to bring data into a Power BI semantic model. However, you notice that access to one of the data sources is restricted to a very short time window.

How should you configure the dataflow? 