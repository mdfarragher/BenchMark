---
title: "Evaluate KQL Query Optimization Approach"
type: "question"
layout: "single"
answers:
    - id: "answer1"
      title: "Yes, this solution meets the goal"
      correct: false
      explain: "Adding the make_list() aggregation function does not improve query performance. In fact, make_list() creates arrays of values which adds computational overhead and memory consumption. The original performance issue is that the filter is applied after the expensive join operation, and make_list() doesn't address this problem."
    - id: "answer2"
      title: "No, this solution does not meet the goal"
      correct: true
      explain: "Adding make_list() aggregation does not reduce query execution time. The performance bottleneck in the query is that the Temperature filter is applied after joining millions of rows from Stream and Reference tables. The make_list() function would add additional processing overhead without addressing the core issue. The correct optimization would be to move the filter before the join operation."
link: "https://learn.microsoft.com/en-us/kusto/query/kql-quick-reference"
more: "Learn more about KQL query optimization"
learn: "KQL Query Optimization"
---
You work for MDFT Pro, a well-known training agency that operates IoT-enabled smart classrooms across multiple campuses. Mark, a Real-Time Analytics Specialist at MDFT Pro, manages a KQL database that tracks environmental conditions in classrooms to ensure optimal learning environments. The database contains two tables: Stream (with millions of streaming sensor readings including timestamp, geolocation, temperature, and device ID from classroom sensors) and Reference (with device information mapping device IDs to classroom names and locations). Mark has written a KQL query that joins these tables, extracts latitude and longitude from geolocation data, filters for temperatures above 10 degrees, and renders the results on a map. However, the query takes too long to execute because it processes millions of rows through the join operation before applying the temperature filter. A colleague suggests adding the make_list() function to aggregate the output columns, claiming this will reduce processing time by grouping the results.

The current query is:
```kql
Stream
| extend lat = todecimal(GeoLocation.Latitude), long = todecimal(GeoLocation.Longitude)
| join kind = inner Reference on DeviceId
| project Timestamp, lat, long, Temperature, DeviceName
| filter Temperature >= 10
| render scatterchart with (kind = map)
```

Does adding the make_list() function to the output columns meet the goal of reducing query execution time?
