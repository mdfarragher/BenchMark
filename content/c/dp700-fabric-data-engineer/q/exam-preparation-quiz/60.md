---
title: "Complete The KQL Query To Compare Values"
type: "question"
layout: "single"
answers:
    - id: "answer1"
      title: "evaluate"
      correct: false
      explain: "The evaluate operator is used to invoke query-level plugin operators, not for adding calculated columns to the result set."
    - id: "answer2"
      title: "extend"
      correct: true
      explain: "The extend operator creates new calculated columns and adds them to the result set, making it the correct choice for adding PrevMeterReading and PrevTimestamp columns based on the prev() function."
    - id: "answer3"
      title: "lookup"
      correct: false
      explain: "The lookup operator is used for enriching data by joining with a dimension table, not for creating calculated columns based on row functions like prev()."
    - id: "answer4"
      title: "window"
      correct: false
      explain: "While the window operator can be used for window functions, it's not the standard approach in KQL for simply adding calculated columns with the prev() function."
    - id: "answer5"
      title: "match"
      correct: false
      explain: "The match operator is used for pattern matching across multiple tables, not for adding calculated columns to a result set."
    - id: "answer6"
      title: "select"
      correct: false
      explain: "Select is not a valid KQL operator; KQL uses project to select specific columns from the result set."
link: "https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/extend-operator"
more: "Learn more about the KQL extend operator"
learn: "KQL Extend Operator"
---
You work as a Data Analyst for Mark at MDFT Pro, a well-known training agency. MDFT Pro operates a KQL database that tracks utility meter readings across various training facilities. The database contains a table named Readings that stores meter reading data including city, area, meter reading values, and timestamps. Mark has asked you to create a KQL query that compares each meter reading value to the previous reading based on the timestamp, allowing the agency to monitor consumption patterns across their facilities. The expected output should show each reading alongside the previous reading and its timestamp for easy comparison.

| City   | Area  | MeterReading | Timestamp           | PrevMeterReading | PrevTimestamp       |
| ------ | ----- | ------------ | ------------------- | ---------------- | ------------------- |
| Kansas | Area1 | 1500         | 2024-07-30 10:00:00 |                  |                     |
| Kansas | Area2 | 1520         | 2024-07-30 11:00:00 | 1500             | 2024-07-30 10:00:00 |

How should you complete the KQL query below to reproduce this output?

```kql
Readings
| filter City == "Kansas"
| sort by Timestamp
| _____________ PrevMeterReading = prev(MeterReading)
    PrevTimestamp = prev(Timestamp)
| project City, Area, MeterReading, Timestamp, PrevMeterReading, PrevTimestamp
```
